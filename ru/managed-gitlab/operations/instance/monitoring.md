---
title: Мониторинг состояния инстанса {{ GL }} и хостов
description: Вы можете отслеживать состояние инстанса {{ mgl-name }} с помощью инструментов мониторинга в консоли управления. Эти инструменты предоставляют диагностическую информацию в виде графиков. Также вы можете настроить алерты {{ monitoring-full-name }} для автоматического мониторинга состояния инстанса.
---

# Мониторинг состояния инстанса {{ mgl-name }}

{% include [note-preview](../../../_includes/note-preview.md) %}

Данные о состоянии инстанса можно посмотреть на вкладке **{{ ui-key.yacloud.common.monitoring }}** страницы инстанса или в сервисе [{{ monitoring-full-name }}](../../../monitoring/concepts/index.md).

Диагностическая информация о состоянии инстанса представлена в виде графиков. На них автоматически применяются наиболее подходящие кратные единицы измерения (гигабайты, проценты и т. д.).

{% include [alerts](../../../_includes/mdb/alerts.md) %}

## Мониторинг состояния инстанса {#view-graphs}

Для просмотра детальной информации о состоянии инстанса {{ mgl-name }}:

1. Перейдите на [страницу каталога]({{ link-console-main }}) и выберите сервис **{{ ui-key.yacloud.iam.folder.dashboard.label_managed-gitlab }}**.
1. Нажмите на имя нужного инстанса и выберите вкладку **{{ ui-key.yacloud.common.monitoring }}**.
1. {% include [open-in-yandex-monitoring](../../../_includes/mdb/open-in-yandex-monitoring.md) %}

На странице появятся следующие графики:

* **Data disk** — количество занятого и свободного места на диске для хранения данных.
* **System disk** — количество занятого и свободного места в системном хранилище.
* **CPU** — загрузка процессорных ядер.
* **Memory** — использование оперативной памяти. При высоких нагрузках значение параметра **Available memory** уменьшается, а **Used memory** — растет.

## Настройка алертов в {{ monitoring-name }} {#monitoring-integration}

{% list tabs group=instructions %}

- Консоль управления {#console}

   1. В [консоли управления]({{ link-console-main }}) выберите каталог с инстансом, для которого нужно настроить алерты.
   1. В списке сервисов выберите ![image](../../../_assets/console-icons/display-pulse.svg) **{{ ui-key.yacloud.iam.folder.dashboard.label_monitoring }}**.
   1. На главной странице в блоке **{{ ui-key.yacloud_monitoring.homepage.title_service-dashboards }}** выберите **Managed Gitlab**.
   1. На нужном графике нажмите на значок ![options](../../../_assets/console-icons/ellipsis.svg) и выберите пункт **{{ ui-key.yacloud_monitoring.alert.button_create-alert }}**.
   1. Если на выбранном графике несколько показателей, в разделе **{{ ui-key.yacloud_monitoring.monitoring-alerts.title.alert-config }}** вы можете оставить все запросы данных или только некоторые из них. Например, для метрики **System disk** можно удалить лишний запрос на свободное место в хранилище и оставить только запрос на занятое место.

      Чтобы убрать лишний запрос, в его строке нажмите ![options](../../../_assets/console-icons/ellipsis.svg) → **{{ ui-key.yacloud_monitoring.actions.common.delete }}**.

      Подробнее о языке запросов см. [документацию {{ monitoring-name }}](../../../monitoring/concepts/querying.md).

   1. Задайте [условия срабатывания алерта](../../../monitoring/concepts/alerting/alert.md#condition):

      * Задайте имя запроса, по которому будет вычисляться статус алерта.

      * Выберите функцию агрегации, которая будет применяться к значениям метрик во временном окне.

      * Выберите функцию сравнения, которая будет сравнивать результат функции агрегации и пороговые значения.

      * Укажите значения порогов `{{ ui-key.yacloud_monitoring.alert-template.threshold-status.warn }}` и `{{ ui-key.yacloud_monitoring.alert-template.threshold-status.alarm }}`. Выберите, должно ли текущее значение на графике быть больше, меньше установленного порога или равно ему. 

      * Задайте временное окно, в котором рассчитывается алерт, и задержку вычисления.

   1. Нажмите кнопку **{{ ui-key.yacloud_monitoring.actions.common.create }}**.

{% endlist %}

Вы также можете создать алерты на конкретные метрики {{ mgl-name }}. 

Рекомендуемые значения порогов для некоторых метрик:

Рекомендуемые значения порогов для метрики **Оставшееся свободное место на диске** (`sys.filesystem.FreeB`):

1. **{{ ui-key.yacloud_monitoring.monitoring-alerts.threshold-table.evaluation-type }}** — **Среднее**.
1. **{{ ui-key.yacloud_monitoring.monitoring-alerts.threshold-table.trigger-condition }}** — **Меньше или равно**.
1. **{{ ui-key.yacloud_monitoring.alert-template.threshold-status.alarm }}** — 7% от размера хранилища.
1. **{{ ui-key.yacloud_monitoring.alert-template.threshold-status.warn }}** — 10% от размера хранилища.
1. **{{ ui-key.yacloud_monitoring.monitoring-alerts.title.evaluation-window }}** — 5 минут.
1. **{{ ui-key.yacloud_monitoring.monitoring-alerts.title.time-shift }}** — 30 секунд.

## Статусы инстанса {#statuses}

_Статус_ показывает, запущен ли инстанс, остановлен или находится в промежуточном состоянии. Статус можно посмотреть в списке инстансов {{ mgl-name }} и на странице каждого инстанса.

Возможные статусы:

#|
|| **Статус** | **Описание** | **Предлагаемые действия** ||
|| **CREATING** | Идет подготовка к первому запуску | Подождите немного и приступайте к работе. Время создания инстанса зависит от класса хостов. ||
|| **RUNNING** | Инстанс работает в штатном режиме | Действий не требуется. ||
|| **STOPPING** | Инстанс останавливается | Через некоторое время инстансу будет присвоен статус `STOPPED`, и он будет выведен из работы. Действий не требуется. ||
|| **STOPPED** | Инстанс остановлен | Запустите инстанс, чтобы вернуть его в работу. ||
|| **STARTING** | Остановленный ранее инстанс запускается | Через некоторое время инстансу будет присвоен статус `RUNNING`. Подождите немного и приступайте к работе. ||
|| **UPDATING** | Выполняется обновление инстанса | По завершении обновления ему будет присвоен статус `RUNNING`. Подождите немного и приступайте к работе. ||
|| **ERROR** | Произошла ошибка, которая не позволяет инстансу продолжить работу | Выполните начальную диагностику:

* Проанализируйте [графики мониторинга](#view-graphs) инстанса.
* В разделе ![image](../../../_assets/console-icons/list-check.svg) **{{ ui-key.yacloud.common.operations-key-value }}** на странице инстанса посмотрите, какие операции в нем выполнялись.

Если причины ошибки не удалось выяснить самостоятельно, [обратитесь в службу поддержки]({{ link-console-support }}). ||
|| **STATUS_UNKNOWN** | Инстанс не может определить свой статус | Выполните начальную диагностику:

* Проанализируйте [графики мониторинга](#view-graphs) инстанса.
* В разделе ![image](../../../_assets/console-icons/list-check.svg) **{{ ui-key.yacloud.common.operations-key-value }}** на странице инстанса посмотрите, какие операции в нем выполнялись.

Если причины ошибки не удалось выяснить самостоятельно, обратитесь в службу поддержки. ||
|| **DELETING** | Инстанс удаляется | По завершении удаления инстанс исчезнет со страницы **{{ ui-key.yacloud.gitlab.label_instances-title }}** и больше не будет доступен. Действий не требуется.

При удалении инстанса автоматически создается резервная копия, которая хранится в течение двух недель. Если после удаления нужно восстановить инстанс, обратитесь в службу поддержки. ||
|#
