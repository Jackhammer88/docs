#### Как создать пользователя для доступа из {{ datalens-name }} с правами только на чтение? {#datalens-readonly}

Воспользуйтесь [инструкцией](../../managed-clickhouse/operations/cluster-users.md#example-create-readonly-user), чтобы создать пользователя с правами только на чтение. Если в настройках кластера [включена опция](../../managed-clickhouse/operations/update.md#change-additional-settings) **{{ ui-key.yacloud.mdb.cluster.overview.label_access-datalens }}**, сервис сможет [подключаться](../../managed-clickhouse/operations/datalens-connect.md#create-connector) к кластеру с помощью этого пользователя.

#### Как дать пользователю права на создание и удаление таблиц или БД? {#create-delete-role}

Включите в настройках кластера опцию [{#T}](../../managed-clickhouse/operations/cluster-users.md#sql-user-management) и выдайте пользователю нужные права [с помощью выражения]({{ ch.docs }}/sql-reference/statements/grant/) `GRANT`.

#### Как узнать значение настройки internal_replication? {#internal-replication}

Информация о настройке `internal_replication` недоступна ни в интерфейсах {{ yandex-cloud }}, ни в системных таблицах {{ CH }}. Значение настройки по умолчанию — `true`.

#### Как повысить максимальный объем оперативной памяти для выполнения запроса? {#max-memory-usage}

Если для выполнения запроса не хватает объема оперативной памяти пользователя, возникает ошибка:

```text
DB::Exception: Memory limit (total) exceeded:
would use 14.10 GiB (attempt to allocate chunk of 4219924 bytes), maximum: 14.10 GiB.
(MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below)
```

Для [увеличения](../../managed-clickhouse/operations/cluster-users.md#update-settings) максимального объема оперативной памяти используйте параметр [Max memory usage](../../managed-clickhouse/concepts/settings-list.md#setting-max-memory-usage).

Если в кластере включена опция [Управление пользователями через SQL](../../managed-clickhouse/operations/cluster-users.md#sql-user-management), параметр `Max memory usage` можно задать:

* Для сессии текущего пользователя с помощью запроса:

    ```sql
    SET max_memory_usage = <значение_в_байтах>;
    ```

* Для всех пользователей по умолчанию с помощью создания [профиля настроек]({{ ch.docs }}/operations/access-rights/#settings-profiles-management).

#### Почему в кластере {{ mch-name }} должно быть три или пять хостов {{ ZK }}? {#zookeeper-hosts-number}

{{ ZK }} использует алгоритм консенсуса: сервис продолжает функционировать, пока большинство хостов {{ ZK }} находятся в рабочем состоянии.

Например, если кластер имеет два хоста {{ ZK }}, то при отключении одного из них оставшийся хост не составляет большинство, поэтому сервис становится недоступным. Таким образом, кластер с двумя хостами {{ ZK }} не обладает отказоустойчивостью.

Кластер с тремя хостами {{ ZK }} уже обладает отказоустойчивостью. При падении или обслуживании одного из них кластер сохраняет работоспособность. Таким образом, три — минимальное рекомендуемое число хостов {{ ZK }} в кластере {{ mch-name }}.

Кластер с четырьмя хостами {{ ZK }} не имеет преимуществ перед кластером с тремя хостами: он также способен функционировать при отключении только одного хоста. При отключении двух хостов консенсус не соблюдается и сервис становится недоступным.

Кластер с пятью хостами {{ ZK }} уже способен выдерживать отключение двух хостов, так как три из пяти хостов составляют большинство. Поэтому обслуживать такой кластер удобнее, чем кластер с тремя хостами. Даже если один из пяти хостов [находится на обслуживании](../../managed-clickhouse/concepts/maintenance.md) или перезапускается, кластер остается отказоустойчивым, т. е. выдерживает отключение еще одного хоста.

Добавление в кластер более пяти хостов {{ ZK }} обычно не оправдано. С ростом числа хостов {{ ZK }} увеличиваются затраты времени на их взаимодействие, а скорость сервиса снижается.

Таким образом, в кластере {{ mch-name }} рекомендуется создавать три или пять хостов {{ ZK }}.
