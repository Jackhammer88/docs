#### Как исключить хост из выбора мастером? {#excluded-host}

Вы можете исключить хост из выбора мастером при автоматической или ручной смене хоста-мастера. Для этого настройте [каскадную репликацию](../../managed-postgresql/concepts/replication.md#replication-manual): [укажите](../../managed-postgresql/operations/hosts.md#update) источник репликации для хоста, который не должен становиться мастером.

{% note warning %}

Для обеспечения [высокой доступности](../../architecture/fault-tolerance.md#mdb-ha) во время технического обслуживания в кластере должен быть хотя бы один хост-реплика без источника репликации.

{% endnote %}

#### Можно ли настроить мультимастер в кластере или между двумя кластерами? {#setting-multimaster}

Нет, в сервисе {{ mpg-name }} не поддерживается настройка мультимастера.

Подробнее об обеспечении высокой доступности кластера см. в разделе [{#T}](../../architecture/fault-tolerance.md#mdb-ha).

#### Как настроить балансировку, чтобы запросы на чтение отправлялись только на реплики? {#balancing-replicas}

Балансировка не осуществляется на стороне {{ mpg-name }}, поэтому ее необходимо реализовать в бэкенде вашего приложения. Чтобы отправлять запросы на чтение репликам, приложение должно определить самостоятельно, какой из хостов является репликой, а какой — мастером. Например, это можно сделать с помощью библиотеки `libpq`. Подробнее см. в [документации {{ PG }}](https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNECT-TARGET-SESSION-ATTRS).

Либо вы можете воспользоваться [особым FQDN](../../managed-postgresql/operations/connect.md#fqdn-replica), который указывает на наименее отстающую реплику.

Дополнительные сведения см. в разделе [Высокая доступность](../../managed-postgresql/concepts/high-availability.md).

#### Почему мастер переключается на случайно выбранный хост при отключенной опции автоматического переключения мастера? {#auto-failover-master}

Во время операций [изменения кластера](../../managed-postgresql/operations/update.md) и в рамках [технического обслуживания](../../managed-postgresql/concepts/maintenance.md) хост-мастер может переключиться на другой хост даже при запрете на автоматическое переключение. Это сделано для обеспечения правильной работы кластера при указанных действиях.

{% note info %}

Чтобы обеспечить [высокую доступность](../../managed-postgresql/concepts/high-availability.md), в кластере всегда есть хотя бы одна реплика без явно указанного [источника репликации](../../managed-postgresql/concepts/replication.md#replication-manual), которая может стать мастером.

{% endnote %}

#### Почему при восстановлении работоспособности кластера происходит смена мастера, несмотря на отключенную опцию автоматического переключения мастера? {#auto-failover-restore}

Хост-мастер может переключиться на другой хост при восстановлении работоспособности даже при запрете на автоматическое переключение. Это сделано для обеспечения правильной работы кластера в указанных условиях. Подробнее читайте в разделе [{#T}](../../managed-postgresql/concepts/high-availability.md).

#### Почему во время операций обслуживания происходит автоматическое переключение мастера, хотя эта опция выключена? {#auto-failover-maintenance}

Хост-мастер может переключиться на другой хост даже при запрете на автоматическое переключение, чтобы обеспечить [выполнение технического обслуживания](../../managed-postgresql/concepts/high-availability.md#maintenance-settings).
